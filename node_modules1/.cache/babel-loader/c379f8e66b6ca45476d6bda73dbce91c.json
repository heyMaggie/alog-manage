{"ast":null,"code":"import _toConsumableArray from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\n// import routes from \"@/config/routes.js\";\nvar RouterInitialState = {\n  path: sessionStorage.currentPath ? sessionStorage.currentPath : null,\n  module: null,\n  title: null,\n  matchedRoutes: null,\n  query: null,\n  params: null,\n  tabs: sessionStorage.tabs ? JSON.parse(sessionStorage.tabs) : [],\n  // currentTab: sessionStorage.currentPath ? sessionStorage.currentPath : null,\n  routes: window.routes,\n  // tabs: [],\n  currentTab: null,\n  // routes: null,\n  currentTabKey: null,\n  currentTabQuery: null,\n  history: {},\n  tabReloading: false //刷新\n\n};\nvar ENTER_ROUTE = \"ENTER_ROUTE\";\nvar SET_TITLE = \"SET_TITLE\";\nvar CHANGE_TAB = \"CHANGE_TAB\"; // const STORE_ROUTES = \"STORE_ROUTES\";\n\nvar PUSH_TAB = \"PUSH_TAB\";\nvar POP_TAB = \"POP_TAB\";\nvar POP_OTHER_TAB = \"POP_OTHER_TAB\";\nvar POP_LEFT_TAB = \"POP_LEFT_TAB\";\nvar POP_RIGHT_TAB = \"POP_RIGHT_TAB\"; //刷新\n\nvar RElOAD_TAB = \"RElOAD_TAB\";\nvar FINISH_RElOAD = \"FINISH_RElOAD\";\n\nvar RouterModel = function RouterModel() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : RouterInitialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  // console.log(state);\n  // console.log(action);\n  switch (action.type) {\n    case ENTER_ROUTE:\n      var _action$payload = action.payload,\n          path = _action$payload.path,\n          routes = _action$payload.routes;\n\n      if (state.tabs.includes(path)) {\n        // console.log(\"已经有了\");\n        return Object.assign({}, state, {\n          path: path\n        });\n      } else {\n        if (state.routes) {\n          return Object.assign({}, state, {\n            path: path,\n            tabs: [].concat(_toConsumableArray(state.tabs), [path])\n          });\n        } else {\n          return Object.assign({}, state, {\n            path: path,\n            tabs: [].concat(_toConsumableArray(state.tabs), [path]),\n            routes: routes\n          });\n        }\n      }\n\n      return state;\n\n    case RElOAD_TAB:\n      return Object.assign({}, state, {\n        tabReloading: true\n      });\n\n    case FINISH_RElOAD:\n      return Object.assign({}, state, {\n        tabReloading: false\n      });\n\n    case CHANGE_TAB:\n      //改变tabs\n      return Object.assign({}, state, {\n        path: action.payload\n      });\n\n    case PUSH_TAB:\n      return state;\n\n    case POP_TAB:\n      var tabs = _toConsumableArray(state.tabs); //  action.payload ： 要删除的tab\n\n\n      var index = tabs.indexOf(action.payload); //currentPath：当前激活的tab\n\n      var currentPath = state.path; // console.log(\"当前激活的tab: \", currentPath);\n\n      if (index > -1) {\n        //删除tab\n        tabs.splice(index, 1); //改变 激活的tab\n\n        if (action.payload == currentPath) {\n          var lastIndex = index - 1;\n\n          if (lastIndex >= 0) {\n            currentPath = tabs[lastIndex];\n          } else {\n            currentPath = tabs[0];\n          }\n        }\n      }\n\n      return Object.assign({}, state, {\n        path: currentPath,\n        tabs: tabs\n      });\n\n    case POP_OTHER_TAB:\n      var tabs = _toConsumableArray(state.tabs); //要删除除 所选tab 之外的tab\n\n\n      var newArr = tabs.filter(function (item) {\n        return item == action.payload;\n      });\n      return Object.assign({}, state, {\n        path: action.payload,\n        tabs: newArr\n      });\n\n    case POP_LEFT_TAB:\n      var tabs = _toConsumableArray(state.tabs);\n\n      var index = tabs.indexOf(action.payload); //要删除除 所选tab 左边的tab\n\n      var newArr = tabs.filter(function (item, idx) {\n        return idx >= index;\n      });\n      var nowIndex = tabs.indexOf(state.path);\n\n      if (nowIndex < index) {\n        return Object.assign({}, state, {\n          path: action.payload,\n          tabs: newArr\n        });\n      } else {\n        return Object.assign({}, state, {\n          tabs: newArr\n        });\n      }\n\n    case POP_RIGHT_TAB:\n      var tabs = _toConsumableArray(state.tabs);\n\n      var index = tabs.indexOf(action.payload); //要删除除 所选tab 右边的tab\n\n      var newArr = tabs.filter(function (item, idx) {\n        return idx <= index;\n      });\n      var nowIndex = tabs.indexOf(state.path);\n\n      if (nowIndex > index) {\n        return Object.assign({}, state, {\n          path: action.payload,\n          tabs: newArr\n        });\n      } else {\n        return Object.assign({}, state, {\n          tabs: newArr\n        });\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default RouterModel;","map":{"version":3,"sources":["D:/company/algo-manage/src/store/modules/RouterModel.js"],"names":["RouterInitialState","path","sessionStorage","currentPath","module","title","matchedRoutes","query","params","tabs","JSON","parse","routes","window","currentTab","currentTabKey","currentTabQuery","history","tabReloading","ENTER_ROUTE","SET_TITLE","CHANGE_TAB","PUSH_TAB","POP_TAB","POP_OTHER_TAB","POP_LEFT_TAB","POP_RIGHT_TAB","RElOAD_TAB","FINISH_RElOAD","RouterModel","state","action","type","payload","includes","Object","assign","index","indexOf","splice","lastIndex","newArr","filter","item","idx","nowIndex"],"mappings":"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","sourcesContent":["// import routes from \"@/config/routes.js\";\r\n\r\nconst RouterInitialState = {\r\n    path: sessionStorage.currentPath ? sessionStorage.currentPath : null,\r\n    module: null,\r\n    title: null,\r\n    matchedRoutes: null,\r\n    query: null,\r\n    params: null,\r\n\r\n    tabs: sessionStorage.tabs ? JSON.parse(sessionStorage.tabs) : [],\r\n    // currentTab: sessionStorage.currentPath ? sessionStorage.currentPath : null,\r\n    routes: window.routes,\r\n\r\n    // tabs: [],\r\n    currentTab: null,\r\n    // routes: null,\r\n    currentTabKey: null,\r\n    currentTabQuery: null,\r\n    history: {},\r\n    tabReloading: false, //刷新\r\n};\r\n\r\nconst ENTER_ROUTE = \"ENTER_ROUTE\";\r\nconst SET_TITLE = \"SET_TITLE\";\r\nconst CHANGE_TAB = \"CHANGE_TAB\";\r\n// const STORE_ROUTES = \"STORE_ROUTES\";\r\nconst PUSH_TAB = \"PUSH_TAB\";\r\nconst POP_TAB = \"POP_TAB\";\r\nconst POP_OTHER_TAB = \"POP_OTHER_TAB\";\r\nconst POP_LEFT_TAB = \"POP_LEFT_TAB\";\r\nconst POP_RIGHT_TAB = \"POP_RIGHT_TAB\";\r\n//刷新\r\nconst RElOAD_TAB = \"RElOAD_TAB\";\r\nconst FINISH_RElOAD = \"FINISH_RElOAD\";\r\n\r\nconst RouterModel = (state = RouterInitialState, action) => {\r\n    // console.log(state);\r\n    // console.log(action);\r\n    switch (action.type) {\r\n        case ENTER_ROUTE:\r\n            let { path, routes } = action.payload;\r\n            if (state.tabs.includes(path)) {\r\n                // console.log(\"已经有了\");\r\n                return Object.assign({}, state, {\r\n                    path,\r\n                });\r\n            } else {\r\n                if (state.routes) {\r\n                    return Object.assign({}, state, {\r\n                        path,\r\n                        tabs: [...state.tabs, path],\r\n                    });\r\n                } else {\r\n                    return Object.assign({}, state, {\r\n                        path,\r\n                        tabs: [...state.tabs, path],\r\n                        routes,\r\n                    });\r\n                }\r\n            }\r\n            return state;\r\n        case RElOAD_TAB:\r\n            return Object.assign({}, state, {\r\n                tabReloading: true,\r\n            });\r\n        case FINISH_RElOAD:\r\n            return Object.assign({}, state, {\r\n                tabReloading: false,\r\n            });\r\n        case CHANGE_TAB: //改变tabs\r\n            return Object.assign({}, state, {\r\n                path: action.payload,\r\n            });\r\n        case PUSH_TAB:\r\n            return state;\r\n        case POP_TAB:\r\n            var tabs = [...state.tabs];\r\n            //  action.payload ： 要删除的tab\r\n            var index = tabs.indexOf(action.payload);\r\n            //currentPath：当前激活的tab\r\n            var currentPath = state.path;\r\n            // console.log(\"当前激活的tab: \", currentPath);\r\n            if (index > -1) {\r\n                //删除tab\r\n                tabs.splice(index, 1);\r\n                //改变 激活的tab\r\n                if (action.payload == currentPath) {\r\n                    let lastIndex = index - 1;\r\n                    if (lastIndex >= 0) {\r\n                        currentPath = tabs[lastIndex];\r\n                    } else {\r\n                        currentPath = tabs[0];\r\n                    }\r\n                }\r\n            }\r\n            return Object.assign({}, state, {\r\n                path: currentPath,\r\n                tabs: tabs,\r\n            });\r\n        case POP_OTHER_TAB:\r\n            var tabs = [...state.tabs];\r\n            //要删除除 所选tab 之外的tab\r\n            var newArr = tabs.filter((item) => item == action.payload);\r\n            return Object.assign({}, state, {\r\n                path: action.payload,\r\n                tabs: newArr,\r\n            });\r\n        case POP_LEFT_TAB:\r\n            var tabs = [...state.tabs];\r\n            var index = tabs.indexOf(action.payload);\r\n            //要删除除 所选tab 左边的tab\r\n            var newArr = tabs.filter((item, idx) => idx >= index);\r\n            var nowIndex = tabs.indexOf(state.path);\r\n            if (nowIndex < index) {\r\n                return Object.assign({}, state, {\r\n                    path: action.payload,\r\n                    tabs: newArr,\r\n                });\r\n            } else {\r\n                return Object.assign({}, state, {\r\n                    tabs: newArr,\r\n                });\r\n            }\r\n        case POP_RIGHT_TAB:\r\n            var tabs = [...state.tabs];\r\n            var index = tabs.indexOf(action.payload);\r\n            //要删除除 所选tab 右边的tab\r\n            var newArr = tabs.filter((item, idx) => idx <= index);\r\n            var nowIndex = tabs.indexOf(state.path);\r\n            if (nowIndex > index) {\r\n                return Object.assign({}, state, {\r\n                    path: action.payload,\r\n                    tabs: newArr,\r\n                });\r\n            } else {\r\n                return Object.assign({}, state, {\r\n                    tabs: newArr,\r\n                });\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\nexport default RouterModel;\r\n"]},"metadata":{},"sourceType":"module"}