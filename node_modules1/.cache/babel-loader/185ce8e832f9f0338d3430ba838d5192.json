{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _objectWithoutProperties from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/lib/popconfirm/style\";\nimport _Popconfirm from \"antd/lib/popconfirm\";\nimport _regeneratorRuntime from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\company\\\\algo-manage\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\company\\\\algo-manage\\\\src\\\\components\\\\CurdComponent\\\\index.js\";\nimport React from \"react\";\nimport styles from \"./index.module.less\";\nimport SearchForm from \"@/components/SearchForm\";\nimport DynamicModal from \"@/components/DynamicModal\";\nimport Table from \"@/components/Table\";\nimport DynamicDescriptions from \"@/components/DynamicDescriptions\"; // import SplitPane from \"react-split-pane\";\n\nimport UploadWrap from \"@/components/UploadWrap\";\n\nvar CurdComponent =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(CurdComponent, _React$PureComponent);\n\n  function CurdComponent() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CurdComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CurdComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      insertModalVisible: false,\n      updateModalVisible: false,\n      detailModalVisible: false,\n      scroll: _this.props.scroll\n    };\n\n    _this.handleInsertBtn = function () {\n      _this.setState({\n        insertModalVisible: true // updateModalVisible: true\n\n      });\n    };\n\n    _this.handleInsertModalReady = function (_ref) {\n      var form = _ref.form;\n      _this.insertForm = form;\n      var onInsertModalReady = _this.props.onInsertModalReady;\n\n      if (typeof onInsertModalReady == \"function\") {\n        onInsertModalReady({\n          form: form\n        });\n      }\n    };\n\n    _this.handleInsertModalOk = function () {\n      var insertRecord = _this.props.insertRecord;\n\n      if (typeof insertRecord == \"function\") {\n        // insertRecord({ form: this.insertForm });\n        _this.insertForm.validateFields(function (err, values) {\n          if (!err) {\n            var formData = _this.getInsertFormValue();\n\n            for (var key in formData) {\n              if (!formData[key]) {\n                formData[key] = \"\";\n              }\n            }\n\n            insertRecord(formData);\n\n            _this.insertForm.resetFields();\n\n            _this.setState({\n              insertModalVisible: false\n            });\n          }\n        });\n      }\n    };\n\n    _this.handleInsertModalCancel = function () {\n      _this.setState({\n        insertModalVisible: false\n      });\n    };\n\n    _this.handleUpdateModalReady = function (_ref2) {\n      var form = _ref2.form;\n      // console.log(\"handleUpdateModalReady\");\n      _this.updateForm = form;\n      var onUpdateModalReady = _this.props.onUpdateModalReady;\n\n      if (typeof onUpdateModalReady == \"function\") {\n        onUpdateModalReady({\n          form: form\n        });\n      }\n    };\n\n    _this.handleUpdateModalOk = function () {\n      var updateRecord = _this.props.updateRecord;\n\n      if (typeof updateRecord == \"function\") {\n        // updateRecord({ form: this.updateForm });\n        _this.updateForm.validateFields(function (err, values) {\n          if (!err) {\n            updateRecord({\n              form: _this.updateForm\n            }); // this.insertForm.resetFields();\n\n            _this.setState({\n              updateModalVisible: false\n            });\n          }\n        });\n      } // this.setState({\n      //     updateModalVisible: false,\n      // });\n\n    };\n\n    _this.handleUpdateModalCancel = function () {\n      _this.setState({\n        updateModalVisible: false\n      });\n    };\n\n    _this.handleDetailModalCancel = function () {\n      _this.setState({\n        detailModalVisible: false\n      });\n    };\n\n    _this.addUpdateDeleteColumns = function (columns) {\n      var newCol = columns;\n      var _this$props = _this.props,\n          updateRecord = _this$props.updateRecord,\n          deleteRecord = _this$props.deleteRecord,\n          setUpdateModal = _this$props.setUpdateModal;\n      columns.forEach(function (item) {\n        return item.ellipsis = true;\n      });\n\n      if (updateRecord || deleteRecord) {\n        newCol = [].concat(_toConsumableArray(columns), [{\n          title: \"操作\",\n          key: \"action\",\n          align: \"left\",\n          fixed: \"right\",\n          width: 144,\n          render: function render(text, record) {\n            return React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 110\n              },\n              __self: this\n            }, updateRecord && React.createElement(\"a\", {\n              style: {\n                color: \"rgba(94,156,221,1)\"\n              },\n              onClick: function onClick() {\n                _this.setState({\n                  updateModalVisible: true\n                });\n\n                if (_this.updateForm) {\n                  setUpdateModal({\n                    form: _this.updateForm,\n                    record: record\n                  });\n                } else {\n                  //第一次 updateModal 需要创建 动态表单\n                  setTimeout(function () {\n                    setUpdateModal({\n                      form: _this.updateForm,\n                      record: record\n                    });\n                  }, 0);\n                }\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 112\n              },\n              __self: this\n            }, \"\\u7F16\\u8F91\"), deleteRecord && React.createElement(_Popconfirm, {\n              title: \"\\u662F\\u5426\\u786E\\u8BA4\\u5220\\u9664?\",\n              onConfirm:\n              /*#__PURE__*/\n              _asyncToGenerator(\n              /*#__PURE__*/\n              _regeneratorRuntime.mark(function _callee() {\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        return _context.abrupt(\"return\", deleteRecord(record));\n\n                      case 1:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              })),\n              okText: \"\\u786E\\u8BA4\",\n              cancelText: \"\\u53D6\\u6D88\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 138\n              },\n              __self: this\n            }, React.createElement(\"a\", {\n              style: {\n                color: \"rgba(240, 95, 94, 1)\",\n                margin: \"0 0 0 24px\"\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 146\n              },\n              __self: this\n            }, \"\\u5220\\u9664\")));\n          }\n        }]);\n      }\n\n      return newCol;\n    };\n\n    _this.computeTableY = function () {\n      var pageWraper = document.querySelector(\".pageId\" + _this.pageId);\n      var thHeight = pageWraper.querySelector(\".ant-table-thead\").offsetHeight;\n      var pagiDiv = pageWraper.querySelector(\".ant-pagination.ant-table-pagination\");\n\n      if (pagiDiv) {\n        var pagiHeight = pagiDiv.offsetHeight;\n        var pagiMt = getComputedStyle(pagiDiv).marginTop.replace(/px/, \"\") / 1;\n        var pagiMb = getComputedStyle(pagiDiv).marginBottom.replace(/px/, \"\") / 1; // console.log(thHeight + pagiHeight + pagiMt + pagiMb);\n\n        var computeY = _this.refs.tableWrap.clientHeight - thHeight - pagiHeight - pagiMt - pagiMb;\n\n        _this.setState({\n          scroll: Object.assign({}, _this.state.scroll, {\n            y: computeY\n          })\n        }, function () {\n          _this.refs.tableWrap.querySelector(\".ant-table-body\").style.height = computeY + \"px\";\n        });\n      } else {\n        _this.setState({\n          scroll: Object.assign({}, _this.state.scroll, {\n            y: 0\n          })\n        }, function () {\n          _this.refs.tableWrap.querySelector(\".ant-table-body\").style.height = \"54px\";\n        });\n      }\n    };\n\n    _this.getInsertFormFields = function () {\n      if (typeof _this.props.getInsertFormFields == \"function\") {\n        var dataArr = _this.props.getInsertFormFields();\n\n        for (var i = 0; i < dataArr.length; i++) {\n          var item = dataArr[i];\n\n          if (!_this.insertId) {\n            _this.insertId = parseInt(Math.random() * 100000000);\n          }\n\n          item.id = item.id + \"_add\" + _this.insertId;\n        }\n\n        return dataArr;\n      }\n    };\n\n    _this.getInsertFormValue = function () {\n      var formData = _this.insertForm.getFieldsValue();\n\n      var newData = {};\n\n      for (var key in formData) {\n        if (formData.hasOwnProperty(key)) {\n          var newKey = key.replace(/_add.*/, \"\");\n          newData[newKey] = formData[key];\n        }\n      }\n\n      return newData;\n    };\n\n    _this.onSearchReady = function (_ref4) {\n      var form = _ref4.form;\n      _this.searchForm = form;\n    };\n\n    _this.getSearchFormFields = function () {\n      var dataArr;\n\n      if (typeof _this.props.getSearchFormFields == \"function\") {\n        dataArr = _this.props.getSearchFormFields();\n      }\n\n      if (Array.isArray(_this.props.getSearchFormFields)) {\n        dataArr = _this.props.getSearchFormFields;\n      }\n\n      for (var i = 0; i < dataArr.length; i++) {\n        var item = dataArr[i];\n\n        if (!_this.searchId) {\n          _this.searchId = parseInt(Math.random() * 100000000);\n        }\n\n        item.id = item.id + \"_search\" + _this.searchId;\n      }\n\n      return dataArr;\n    };\n\n    _this.handleSearch = function () {\n      var params = _this.getSearchFormValue();\n\n      _this.props.onSearchClick(params);\n    };\n\n    _this.getSearchFormValue = function () {\n      var formData = _this.searchForm.getFieldsValue();\n\n      var newData = {};\n\n      for (var key in formData) {\n        var newKey = key.replace(/_search.*/, \"\");\n\n        if (formData[key] != null) {\n          newData[newKey] = formData[key];\n\n          if (newKey == \"startTime\" || newKey == \"endTime\") {\n            newData[newKey] = formData[key].unix();\n          }\n        } else {\n          newData[newKey] = \"\";\n        }\n      }\n\n      return newData;\n    };\n\n    _this.handlePagination = function (pagination) {\n      console.log(\"手动分页 \", pagination);\n\n      var params = _this.getSearchFormValue(pagination);\n\n      _this.props.onSearchClick(params, pagination);\n    };\n\n    _this.handleResize = function () {\n      if (_this.timer) {\n        clearTimeout(_this.timer);\n      }\n\n      _this.timer = setTimeout(function () {\n        _this.computeTableY();\n      }, 30);\n    };\n\n    _this.onDoubleClick = function (record, event) {\n      // console.log(record);\n      _this.record = record;\n\n      _this.setState({\n        detailModalVisible: true\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(CurdComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // this.computeTableY();\n      window.addEventListener(\"resize\", this.handleResize); // this.handleResize();\n    } // static getDerivedStateFromProps(nextProps, prevState) {\n    //     console.log(\"getDerivedStateFromProps\");\n    //     return null;\n    // }\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.dataSource.length != this.props.dataSource.length) {\n        // console.log(\"handleResize\");\n        this.handleResize();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // console.log(\"componentWillUnmount\");\n      window.removeEventListener(\"resize\", this.handleResize);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          _this$props2$rowKey = _this$props2.rowKey,\n          rowKey = _this$props2$rowKey === void 0 ? \"id\" : _this$props2$rowKey,\n          _this$props2$isShowSe = _this$props2.isShowSearchForm,\n          isShowSearchForm = _this$props2$isShowSe === void 0 ? true : _this$props2$isShowSe,\n          getSearchFormFields = _this$props2.getSearchFormFields,\n          onSearchClick = _this$props2.onSearchClick,\n          searchLoading = _this$props2.searchLoading,\n          _this$props2$insertBt = _this$props2.insertBtnText,\n          insertBtnText = _this$props2$insertBt === void 0 ? \"\" : _this$props2$insertBt,\n          _this$props2$insertMo = _this$props2.insertModalText,\n          insertModalText = _this$props2$insertMo === void 0 ? \"新增记录\" : _this$props2$insertMo,\n          _this$props2$getInser = _this$props2.getInsertFormFields,\n          getInsertFormFields = _this$props2$getInser === void 0 ? function () {} : _this$props2$getInser,\n          _this$props2$updateBt = _this$props2.updateBtnText,\n          updateBtnText = _this$props2$updateBt === void 0 ? \"编辑\" : _this$props2$updateBt,\n          _this$props2$updateMo = _this$props2.updateModalText,\n          updateModalText = _this$props2$updateMo === void 0 ? \"修改记录\" : _this$props2$updateMo,\n          _this$props2$getUpdat = _this$props2.getUpdateFormFields,\n          getUpdateFormFields = _this$props2$getUpdat === void 0 ? function () {} : _this$props2$getUpdat,\n          columns = _this$props2.columns,\n          dataSource = _this$props2.dataSource,\n          scroll = _this$props2.scroll,\n          _this$props2$addBtnAr = _this$props2.addBtnArr,\n          addBtnArr = _this$props2$addBtnAr === void 0 ? null : _this$props2$addBtnAr,\n          rowSelection = _this$props2.rowSelection,\n          _this$props2$dtColumn = _this$props2.dtColumns,\n          dtColumns = _this$props2$dtColumn === void 0 ? [] : _this$props2$dtColumn,\n          detailTitle = _this$props2.detailTitle,\n          rest = _objectWithoutProperties(_this$props2, [\"rowKey\", \"isShowSearchForm\", \"getSearchFormFields\", \"onSearchClick\", \"searchLoading\", \"insertBtnText\", \"insertModalText\", \"getInsertFormFields\", \"updateBtnText\", \"updateModalText\", \"getUpdateFormFields\", \"columns\", \"dataSource\", \"scroll\", \"addBtnArr\", \"rowSelection\", \"dtColumns\", \"detailTitle\"]); // this.pageId = window.pageId++;\n\n\n      if (!this.pageId) {\n        if (!window.pageId) {\n          window.pageId = 1;\n        }\n\n        this.pageId = window.pageId++;\n      }\n\n      if (this.props.onRef) {\n        //如果父组件传来该方法 则调用方法将子组件this指针传过去\n        this.props.onRef(this);\n      }\n\n      var pageSize = 0; // let hasInsert = this.props.hasSlot && sessionStorage.userPrivilege == 0;\n\n      var hasInsert = this.props.children && sessionStorage.userPrivilege == 0; // console.log(hasInsert);\n\n      if (insertBtnText || hasInsert) {\n        pageSize = 12;\n      }\n\n      if (this.props.getSearchFormFields && this.props.getSearchFormFields().length > 0) {\n        // if (this.props.isShowSearchForm) {\n        pageSize = 12;\n\n        if (insertBtnText || hasInsert) {\n          pageSize = 11;\n        }\n      }\n\n      if (this.props.pageSize) {\n        pageSize = this.props.pageSize;\n      } // console.log(\"CurdComponent 渲染 \", this.pageId);\n      // console.log(\"insertBtnText\", insertBtnText);\n      // console.log(\"hasSlot\", this.props.hasSlot);\n\n\n      return React.createElement(\"div\", {\n        className: styles.curdComponent + \" curdWraper\" + \" pageId\" + this.pageId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 377\n        },\n        __self: this\n      }, hasInsert && React.createElement(\"div\", {\n        className: styles.insertWrap,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391\n        },\n        __self: this\n      }, React.createElement(UploadWrap, Object.assign({}, this.props.children.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      }))), isShowSearchForm && React.createElement(\"div\", {\n        className: styles.searchWrap,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396\n        },\n        __self: this\n      }, React.createElement(SearchForm // fields={this.getSearchFormFields()}\n      , {\n        fields: this.props.getSearchFormFields(),\n        addBtn: true,\n        onSearchClick: this.handleSearch,\n        insertBtnText: insertBtnText,\n        searchLoading: searchLoading,\n        pageId: this.pageId,\n        onReady: this.onSearchReady,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }, !this.props.hasSearchSlot && insertBtnText && React.createElement(_Button, {\n        type: \"primary\",\n        icon: \"plus\",\n        onClick: this.handleInsertBtn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 408\n        },\n        __self: this\n      }, insertBtnText), this.props.hasSearchSlot && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      }, this.props.addBtn))), React.createElement(\"div\", {\n        className: styles.pad22,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 452\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        ref: \"tableWrap\",\n        className: styles.tableWrap,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453\n        },\n        __self: this\n      }, React.createElement(Table, {\n        rowKey: rowKey,\n        columns: this.addUpdateDeleteColumns(columns()),\n        dataSource: dataSource,\n        scroll: this.state.scroll,\n        rowSelection: rowSelection // handlePagination={this.handlePagination}\n        ,\n        handlePagination: this.props.handlePagination(),\n        pagination: this.props.pagination,\n        pageSize: pageSize,\n        onDoubleClick: this.onDoubleClick,\n        showDetail: dtColumns.length > 0,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454\n        },\n        __self: this\n      })), React.createElement(DynamicModal, Object.assign({\n        title: insertModalText,\n        visible: this.state.insertModalVisible,\n        fields: this.getInsertFormFields(),\n        onOk: this.handleInsertModalOk,\n        onCancel: this.handleInsertModalCancel,\n        onReady: this.handleInsertModalReady\n      }, rest, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 468\n        },\n        __self: this\n      })), React.createElement(DynamicModal, Object.assign({\n        title: updateModalText,\n        visible: this.state.updateModalVisible,\n        fields: getUpdateFormFields(),\n        onOk: this.handleUpdateModalOk,\n        onCancel: this.handleUpdateModalCancel,\n        onReady: this.handleUpdateModalReady // col=\"2\"\n        // width=\"600px\"\n\n      }, rest, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 477\n        },\n        __self: this\n      })), React.createElement(DynamicDescriptions, Object.assign({\n        title: detailTitle,\n        visible: this.state.detailModalVisible,\n        onCancel: this.handleDetailModalCancel,\n        fields: dtColumns,\n        record: this.record,\n        onReady: this.handleUpdateModalReady,\n        column: this.props.dtCol\n      }, rest, {\n        width: this.props.dtWidth,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 488\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return CurdComponent;\n}(React.PureComponent);\n\nexport default CurdComponent;","map":{"version":3,"sources":["D:/company/algo-manage/src/components/CurdComponent/index.js"],"names":["React","styles","SearchForm","DynamicModal","Table","DynamicDescriptions","UploadWrap","CurdComponent","state","insertModalVisible","updateModalVisible","detailModalVisible","scroll","props","handleInsertBtn","setState","handleInsertModalReady","form","insertForm","onInsertModalReady","handleInsertModalOk","insertRecord","validateFields","err","values","formData","getInsertFormValue","key","resetFields","handleInsertModalCancel","handleUpdateModalReady","updateForm","onUpdateModalReady","handleUpdateModalOk","updateRecord","handleUpdateModalCancel","handleDetailModalCancel","addUpdateDeleteColumns","columns","newCol","deleteRecord","setUpdateModal","forEach","item","ellipsis","title","align","fixed","width","render","text","record","color","setTimeout","margin","computeTableY","pageWraper","document","querySelector","pageId","thHeight","offsetHeight","pagiDiv","pagiHeight","pagiMt","getComputedStyle","marginTop","replace","pagiMb","marginBottom","computeY","refs","tableWrap","clientHeight","Object","assign","y","style","height","getInsertFormFields","dataArr","i","length","insertId","parseInt","Math","random","id","getFieldsValue","newData","hasOwnProperty","newKey","onSearchReady","searchForm","getSearchFormFields","Array","isArray","searchId","handleSearch","params","getSearchFormValue","onSearchClick","unix","handlePagination","pagination","console","log","handleResize","timer","clearTimeout","onDoubleClick","event","window","addEventListener","prevProps","prevState","dataSource","removeEventListener","rowKey","isShowSearchForm","searchLoading","insertBtnText","insertModalText","updateBtnText","updateModalText","getUpdateFormFields","addBtnArr","rowSelection","dtColumns","detailTitle","rest","onRef","pageSize","hasInsert","children","sessionStorage","userPrivilege","curdComponent","insertWrap","searchWrap","hasSearchSlot","addBtn","pad22","dtCol","dtWidth","PureComponent"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Button, Popconfirm } from \"antd\";\r\nimport styles from \"./index.module.less\";\r\nimport SearchForm from \"@/components/SearchForm\";\r\nimport DynamicModal from \"@/components/DynamicModal\";\r\nimport Table from \"@/components/Table\";\r\nimport DynamicDescriptions from \"@/components/DynamicDescriptions\";\r\n// import SplitPane from \"react-split-pane\";\r\nimport UploadWrap from \"@/components/UploadWrap\";\r\n\r\nclass CurdComponent extends React.PureComponent {\r\n    state = {\r\n        insertModalVisible: false,\r\n        updateModalVisible: false,\r\n        detailModalVisible: false,\r\n        scroll: this.props.scroll,\r\n    };\r\n    handleInsertBtn = () => {\r\n        this.setState({\r\n            insertModalVisible: true,\r\n            // updateModalVisible: true\r\n        });\r\n    };\r\n    handleInsertModalReady = ({ form }) => {\r\n        this.insertForm = form;\r\n        let { onInsertModalReady } = this.props;\r\n        if (typeof onInsertModalReady == \"function\") {\r\n            onInsertModalReady({ form });\r\n        }\r\n    };\r\n    handleInsertModalOk = () => {\r\n        let { insertRecord } = this.props;\r\n        if (typeof insertRecord == \"function\") {\r\n            // insertRecord({ form: this.insertForm });\r\n            this.insertForm.validateFields((err, values) => {\r\n                if (!err) {\r\n                    let formData = this.getInsertFormValue();\r\n                    for (let key in formData) {\r\n                        if (!formData[key]) {\r\n                            formData[key] = \"\";\r\n                        }\r\n                    }\r\n                    insertRecord(formData);\r\n                    this.insertForm.resetFields();\r\n                    this.setState({\r\n                        insertModalVisible: false,\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    };\r\n    handleInsertModalCancel = () => {\r\n        this.setState({\r\n            insertModalVisible: false,\r\n        });\r\n    };\r\n    //更新\r\n    handleUpdateModalReady = ({ form }) => {\r\n        // console.log(\"handleUpdateModalReady\");\r\n        this.updateForm = form;\r\n        let { onUpdateModalReady } = this.props;\r\n        if (typeof onUpdateModalReady == \"function\") {\r\n            onUpdateModalReady({ form });\r\n        }\r\n    };\r\n    handleUpdateModalOk = () => {\r\n        let { updateRecord } = this.props;\r\n        if (typeof updateRecord == \"function\") {\r\n            // updateRecord({ form: this.updateForm });\r\n            this.updateForm.validateFields((err, values) => {\r\n                if (!err) {\r\n                    updateRecord({ form: this.updateForm });\r\n                    // this.insertForm.resetFields();\r\n                    this.setState({\r\n                        updateModalVisible: false,\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        // this.setState({\r\n        //     updateModalVisible: false,\r\n        // });\r\n    };\r\n    handleUpdateModalCancel = () => {\r\n        this.setState({\r\n            updateModalVisible: false,\r\n        });\r\n    };\r\n    handleDetailModalCancel = () => {\r\n        this.setState({\r\n            detailModalVisible: false,\r\n        });\r\n    };\r\n    // 增加 操作 按钮\r\n    addUpdateDeleteColumns = (columns) => {\r\n        let newCol = columns;\r\n        let { updateRecord, deleteRecord, setUpdateModal } = this.props;\r\n        columns.forEach((item) => (item.ellipsis = true));\r\n        if (updateRecord || deleteRecord) {\r\n            newCol = [\r\n                ...columns,\r\n                {\r\n                    title: \"操作\",\r\n                    key: \"action\",\r\n                    align: \"left\",\r\n                    fixed: \"right\",\r\n                    width: 144,\r\n                    render: (text, record) => {\r\n                        return (\r\n                            <div>\r\n                                {updateRecord && (\r\n                                    <a\r\n                                        style={{ color: \"rgba(94,156,221,1)\" }}\r\n                                        onClick={() => {\r\n                                            this.setState({\r\n                                                updateModalVisible: true,\r\n                                            });\r\n                                            if (this.updateForm) {\r\n                                                setUpdateModal({\r\n                                                    form: this.updateForm,\r\n                                                    record,\r\n                                                });\r\n                                            } else {\r\n                                                //第一次 updateModal 需要创建 动态表单\r\n                                                setTimeout(() => {\r\n                                                    setUpdateModal({\r\n                                                        form: this.updateForm,\r\n                                                        record,\r\n                                                    });\r\n                                                }, 0);\r\n                                            }\r\n                                        }}\r\n                                    >\r\n                                        编辑\r\n                                    </a>\r\n                                )}\r\n                                {deleteRecord && (\r\n                                    <Popconfirm\r\n                                        title=\"是否确认删除?\"\r\n                                        onConfirm={async () =>\r\n                                            deleteRecord(record)\r\n                                        }\r\n                                        okText=\"确认\"\r\n                                        cancelText=\"取消\"\r\n                                    >\r\n                                        <a\r\n                                            style={{\r\n                                                color: \"rgba(240, 95, 94, 1)\",\r\n                                                margin: \"0 0 0 24px\",\r\n                                            }}\r\n                                        >\r\n                                            删除\r\n                                        </a>\r\n                                    </Popconfirm>\r\n                                )}\r\n                            </div>\r\n                        );\r\n                    },\r\n                },\r\n            ];\r\n        }\r\n        return newCol;\r\n    };\r\n    //计算table scroll 纵向高度\r\n    computeTableY = () => {\r\n        let pageWraper = document.querySelector(\".pageId\" + this.pageId);\r\n        let thHeight =\r\n            pageWraper.querySelector(\".ant-table-thead\").offsetHeight;\r\n        let pagiDiv = pageWraper.querySelector(\r\n            \".ant-pagination.ant-table-pagination\"\r\n        );\r\n        if (pagiDiv) {\r\n            let pagiHeight = pagiDiv.offsetHeight;\r\n            let pagiMt =\r\n                getComputedStyle(pagiDiv).marginTop.replace(/px/, \"\") / 1;\r\n            let pagiMb =\r\n                getComputedStyle(pagiDiv).marginBottom.replace(/px/, \"\") / 1;\r\n            // console.log(thHeight + pagiHeight + pagiMt + pagiMb);\r\n            let computeY =\r\n                this.refs.tableWrap.clientHeight -\r\n                thHeight -\r\n                pagiHeight -\r\n                pagiMt -\r\n                pagiMb;\r\n            this.setState(\r\n                {\r\n                    scroll: Object.assign({}, this.state.scroll, {\r\n                        y: computeY,\r\n                    }),\r\n                },\r\n                () => {\r\n                    this.refs.tableWrap.querySelector(\r\n                        \".ant-table-body\"\r\n                    ).style.height = computeY + \"px\";\r\n                }\r\n            );\r\n        } else {\r\n            this.setState(\r\n                {\r\n                    scroll: Object.assign({}, this.state.scroll, {\r\n                        y: 0,\r\n                    }),\r\n                },\r\n                () => {\r\n                    this.refs.tableWrap.querySelector(\r\n                        \".ant-table-body\"\r\n                    ).style.height = \"54px\";\r\n                }\r\n            );\r\n        }\r\n    };\r\n    //添加随机id\r\n    getInsertFormFields = () => {\r\n        if (typeof this.props.getInsertFormFields == \"function\") {\r\n            let dataArr = this.props.getInsertFormFields();\r\n            for (let i = 0; i < dataArr.length; i++) {\r\n                const item = dataArr[i];\r\n                if (!this.insertId) {\r\n                    this.insertId = parseInt(Math.random() * 100000000);\r\n                }\r\n                item.id = item.id + \"_add\" + this.insertId;\r\n            }\r\n            return dataArr;\r\n        }\r\n    };\r\n    //处理InsertForm结果\r\n    getInsertFormValue = () => {\r\n        let formData = this.insertForm.getFieldsValue();\r\n        let newData = {};\r\n        for (const key in formData) {\r\n            if (formData.hasOwnProperty(key)) {\r\n                let newKey = key.replace(/_add.*/, \"\");\r\n                newData[newKey] = formData[key];\r\n            }\r\n        }\r\n        return newData;\r\n    };\r\n\r\n    onSearchReady = ({ form }) => {\r\n        this.searchForm = form;\r\n    };\r\n    //添加随机id\r\n    getSearchFormFields = () => {\r\n        let dataArr;\r\n        if (typeof this.props.getSearchFormFields == \"function\") {\r\n            dataArr = this.props.getSearchFormFields();\r\n        }\r\n        if (Array.isArray(this.props.getSearchFormFields)) {\r\n            dataArr = this.props.getSearchFormFields;\r\n        }\r\n        for (let i = 0; i < dataArr.length; i++) {\r\n            const item = dataArr[i];\r\n            if (!this.searchId) {\r\n                this.searchId = parseInt(Math.random() * 100000000);\r\n            }\r\n            item.id = item.id + \"_search\" + this.searchId;\r\n        }\r\n        return dataArr;\r\n    };\r\n    handleSearch = () => {\r\n        let params = this.getSearchFormValue();\r\n        this.props.onSearchClick(params);\r\n    };\r\n    //处理SearchForm结果\r\n    getSearchFormValue = () => {\r\n        let formData = this.searchForm.getFieldsValue();\r\n        let newData = {};\r\n        for (const key in formData) {\r\n            let newKey = key.replace(/_search.*/, \"\");\r\n            if (formData[key] != null) {\r\n                newData[newKey] = formData[key];\r\n                if (newKey == \"startTime\" || newKey == \"endTime\") {\r\n                    newData[newKey] = formData[key].unix();\r\n                }\r\n            } else {\r\n                newData[newKey] = \"\";\r\n            }\r\n        }\r\n        return newData;\r\n    };\r\n    handlePagination = (pagination) => {\r\n        console.log(\"手动分页 \", pagination);\r\n        let params = this.getSearchFormValue(pagination);\r\n        this.props.onSearchClick(params, pagination);\r\n    };\r\n    //handleResize 窗口尺寸变化时触发事件\r\n    handleResize = () => {\r\n        if (this.timer) {\r\n            clearTimeout(this.timer);\r\n        }\r\n        this.timer = setTimeout(() => {\r\n            this.computeTableY();\r\n        }, 30);\r\n    };\r\n    onDoubleClick = (record, event) => {\r\n        // console.log(record);\r\n        this.record = record;\r\n        this.setState({ detailModalVisible: true });\r\n    };\r\n    componentDidMount() {\r\n        // this.computeTableY();\r\n        window.addEventListener(\"resize\", this.handleResize);\r\n        // this.handleResize();\r\n    }\r\n    // static getDerivedStateFromProps(nextProps, prevState) {\r\n    //     console.log(\"getDerivedStateFromProps\");\r\n    //     return null;\r\n    // }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (prevProps.dataSource.length != this.props.dataSource.length) {\r\n            // console.log(\"handleResize\");\r\n            this.handleResize();\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        // console.log(\"componentWillUnmount\");\r\n        window.removeEventListener(\"resize\", this.handleResize);\r\n    }\r\n    render() {\r\n        let {\r\n            rowKey = \"id\",\r\n            isShowSearchForm = true, //是否显示 搜索框\r\n            getSearchFormFields, //搜索框的搜索列表\r\n            onSearchClick, //搜索按钮点击事件\r\n            searchLoading, //搜索按钮loading状态\r\n            insertBtnText = \"\", //新增按钮内容\r\n            insertModalText = \"新增记录\", //新增弹框标题\r\n            getInsertFormFields = () => {}, //新增弹框表单内容\r\n            updateBtnText = \"编辑\", //更新按钮内容\r\n            updateModalText = \"修改记录\", //更新弹框标题\r\n            getUpdateFormFields = () => {}, //更新弹框表单内容\r\n            columns, //table 表头\r\n            dataSource, //table 数据源,\r\n            scroll, // table 滚动距离\r\n            addBtnArr = null, //按钮组\r\n            rowSelection, //批量选择\r\n            dtColumns = [], //详情列表\r\n            detailTitle, //详情标题\r\n            ...rest\r\n        } = this.props;\r\n        // this.pageId = window.pageId++;\r\n        if (!this.pageId) {\r\n            if (!window.pageId) {\r\n                window.pageId = 1;\r\n            }\r\n            this.pageId = window.pageId++;\r\n        }\r\n        if (this.props.onRef) {\r\n            //如果父组件传来该方法 则调用方法将子组件this指针传过去\r\n            this.props.onRef(this);\r\n        }\r\n        let pageSize = 0;\r\n        // let hasInsert = this.props.hasSlot && sessionStorage.userPrivilege == 0;\r\n        let hasInsert =\r\n            this.props.children && sessionStorage.userPrivilege == 0;\r\n        // console.log(hasInsert);\r\n        if (insertBtnText || hasInsert) {\r\n            pageSize = 12;\r\n        }\r\n        if (\r\n            this.props.getSearchFormFields &&\r\n            this.props.getSearchFormFields().length > 0\r\n        ) {\r\n            // if (this.props.isShowSearchForm) {\r\n            pageSize = 12;\r\n            if (insertBtnText || hasInsert) {\r\n                pageSize = 11;\r\n            }\r\n        }\r\n        if (this.props.pageSize) {\r\n            pageSize = this.props.pageSize;\r\n        }\r\n        // console.log(\"CurdComponent 渲染 \", this.pageId);\r\n        // console.log(\"insertBtnText\", insertBtnText);\r\n        // console.log(\"hasSlot\", this.props.hasSlot);\r\n        return (\r\n            <div\r\n                className={\r\n                    styles.curdComponent +\r\n                    \" curdWraper\" +\r\n                    \" pageId\" +\r\n                    this.pageId\r\n                }\r\n            >\r\n                {/* {hasInsert && (\r\n                    <div className={styles.insertWrap}>\r\n                        {this.props.children}\r\n                    </div>\r\n                )} */}\r\n                {hasInsert && (\r\n                    <div className={styles.insertWrap}>\r\n                        <UploadWrap {...this.props.children.props}></UploadWrap>\r\n                    </div>\r\n                )}\r\n                {isShowSearchForm && (\r\n                    <div className={styles.searchWrap}>\r\n                        <SearchForm\r\n                            // fields={this.getSearchFormFields()}\r\n                            fields={this.props.getSearchFormFields()}\r\n                            addBtn\r\n                            onSearchClick={this.handleSearch}\r\n                            insertBtnText={insertBtnText}\r\n                            searchLoading={searchLoading}\r\n                            pageId={this.pageId}\r\n                            onReady={this.onSearchReady}\r\n                        >\r\n                            {!this.props.hasSearchSlot && insertBtnText && (\r\n                                <Button\r\n                                    type=\"primary\"\r\n                                    icon=\"plus\"\r\n                                    onClick={this.handleInsertBtn}\r\n                                >\r\n                                    {insertBtnText}\r\n                                </Button>\r\n                            )}\r\n                            {this.props.hasSearchSlot && (\r\n                                <React.Fragment>\r\n                                    {this.props.addBtn}\r\n                                </React.Fragment>\r\n                            )}\r\n                        </SearchForm>\r\n                        {/* <div\r\n                            style={{\r\n                                position: \"relative\",\r\n                            }}\r\n                        >\r\n                            <div\r\n                                style={{\r\n                                    position: \"absolute\",\r\n                                    width: \"100%\",\r\n                                    height: \"1px\",\r\n                                    background: \"#EBEBEB\",\r\n                                    top: \"-1px\",\r\n                                }}\r\n                            ></div>\r\n                        </div> */}\r\n                    </div>\r\n                )}\r\n                {/* {insertBtnText != \"\" && (\r\n                    <div className={styles.insertWrap}>\r\n                        {insertBtnText && (\r\n                            <Button\r\n                                type=\"primary\"\r\n                                icon=\"plus\"\r\n                                onClick={this.handleInsertBtn}\r\n                            >\r\n                                {insertBtnText}\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n                )} */}\r\n                <div className={styles.pad22}></div>\r\n                <div ref=\"tableWrap\" className={styles.tableWrap}>\r\n                    <Table\r\n                        rowKey={rowKey}\r\n                        columns={this.addUpdateDeleteColumns(columns())}\r\n                        dataSource={dataSource}\r\n                        scroll={this.state.scroll}\r\n                        rowSelection={rowSelection}\r\n                        // handlePagination={this.handlePagination}\r\n                        handlePagination={this.props.handlePagination()}\r\n                        pagination={this.props.pagination}\r\n                        pageSize={pageSize}\r\n                        onDoubleClick={this.onDoubleClick}\r\n                        showDetail={dtColumns.length > 0}\r\n                    ></Table>\r\n                </div>\r\n                <DynamicModal\r\n                    title={insertModalText}\r\n                    visible={this.state.insertModalVisible}\r\n                    fields={this.getInsertFormFields()}\r\n                    onOk={this.handleInsertModalOk}\r\n                    onCancel={this.handleInsertModalCancel}\r\n                    onReady={this.handleInsertModalReady}\r\n                    {...rest}\r\n                ></DynamicModal>\r\n                <DynamicModal\r\n                    title={updateModalText}\r\n                    visible={this.state.updateModalVisible}\r\n                    fields={getUpdateFormFields()}\r\n                    onOk={this.handleUpdateModalOk}\r\n                    onCancel={this.handleUpdateModalCancel}\r\n                    onReady={this.handleUpdateModalReady}\r\n                    // col=\"2\"\r\n                    // width=\"600px\"\r\n                    {...rest}\r\n                ></DynamicModal>\r\n                <DynamicDescriptions\r\n                    title={detailTitle}\r\n                    visible={this.state.detailModalVisible}\r\n                    onCancel={this.handleDetailModalCancel}\r\n                    fields={dtColumns}\r\n                    record={this.record}\r\n                    onReady={this.handleUpdateModalReady}\r\n                    column={this.props.dtCol}\r\n                    {...rest}\r\n                    width={this.props.dtWidth}\r\n                ></DynamicDescriptions>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default CurdComponent;\r\n"]},"metadata":{},"sourceType":"module"}